# =============================================================================
# BACKEND Nixpacks Configuration - PYTHON ONLY
# =============================================================================
# Service: MDM Comics Backend (FastAPI)
# Root Directory: backend
# Config Path: backend/railway.json
#
# IMPORTANT: Set NIXPACKS_NO_AUTODETECT=1 in Railway env vars if Node detected
# =============================================================================

# Force Python, explicitly disable all other providers
providers = ["python"]

[phases.setup]
nixPkgs = ["python312Full", "gcc"]
onlyIncludeFiles = ["requirements.txt", "app", "migrations", "*.py"]

[phases.install]
cmds = [
    "pip install --upgrade pip",
    "pip install -r requirements.txt"
]
dependsOn = ["setup"]

[phases.build]
cmds = ["echo 'Python backend ready'"]
dependsOn = ["install"]

[start]
cmd = "uvicorn app.main:app --host 0.0.0.0 --port $PORT"
